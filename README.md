# 🍽️ RestoMaps Analytics

**Аналитическая система для ресторанов и кафе с интеграцией Яндекс.Карт и Notion**

Система для сбора, анализа и визуализации данных о ресторанах, кафе и других заведениях общественного питания. Автоматически парсит отзывы с Яндекс.Карт, синхронизируется с Notion, обрабатывает тексты с помощью NLP и предоставляет удобный веб-интерфейс для анализа.

## 🎯 Основные возможности

### 📊 **Аналитика и визуализация**
- Интерактивные карты с фильтрацией по городам, типам заведений и рейтингам
- Детальная статистика по каждому ресторану
- Анализ динамики рейтингов и посещений
- Распределение заведений по городам и типам

### 🔄 **Автоматизация**
- Автоматическая синхронизация с Notion (ежедневно в 06:00)
- Парсинг новых отзывов с Яндекс.Карт (ежедневно в 08:00)
- NLP обработка текстов отзывов (ежедневно в 09:00)
- Автоматические бэкапы базы данных

### 🤖 **NLP и машинное обучение**
- Автоматическое извлечение тегов из отзывов
- Анализ тональности отзывов
- Кластеризация похожих заведений
- Рекомендательная система

### 🗺️ **Интеграции**
- **Яндекс.Карты** — источник отзывов и рейтингов
- **Notion** — синхронизация с базой знаний
- **PostgreSQL** — хранение данных
- **Streamlit** — веб-интерфейс

## 🆚 Конкурентный анализ и новизна подхода

### **Сравнительный анализ ключевых функций**

**Таблица 4.1:** Сравнительный анализ ключевых функций популярных сервисов анализа ресторанов

| Сервис | Автоматический парсинг отзывов | Интеграция с Notion | Личные заметки | Интерактивная визуализация | Аналитика данных |
|--------|:------------------------------:|:-------------------:|:---------------:|:---------------------------:|:----------------:|
| **RestoMaps Analytics** | ✅ | ✅ | ✅ | ✅ | ✅ |
| **Яндекс.Карты** | ✅ | ❌ | ❌ | ✅ | ❌ |
| **Google Maps** | ✅ | ❌ | ❌ | ✅ | ❌ |
| **TripAdvisor** | ✅ | ❌ | ❌ | ✅ | ❌ |

### **Технологические преимущества**

Система «RestoMaps Analytics» построена на современном технологическом стеке:

- **Python** — обеспечивает гибкость и богатую экосистему библиотек для анализа данных
- **PostgreSQL** — надёжное хранение структурированных данных
- **Streamlit** — быстрая разработка интерактивных интерфейсов
- **Docker** — контейнеризация обеспечивает простоту масштабирования и развёртывания

**Дополнительные технологии:**
- **Selenium WebDriver** — автоматизированный парсинг
- **Асинхронная обработка** — HTTP-запросы для повышения производительности
- **Структурированное логирование** — мониторинг системы
- **Множественные API** — интеграция с внешними сервисами

### **Ключевые преимущества RestoMaps Analytics**

#### 🔄 **1. Автоматизированный сбор и агрегация данных**
- Автоматический парсинг отзывов из Яндекс.Карт
- Синхронизация с Notion для получения актуальной информации
- Агрегация данных из различных источников в единую систему

#### 📝 **2. Интеграция личных и общедоступных данных**
- Объединение личных заметок из Notion с общедоступными отзывами
- Персональные оценки по 4 категориям (еда, сервис, кофе, интерьер)
- Синхронизация данных

#### 🗺️ **3. Интерактивная визуализация с умными фильтрами**
- Интерактивные карты с множественными фильтрами
- Визуализация данных
- Фильтрация по городам, типам заведений, рейтингам

#### 📊 **4. Комплексная аналитика**
- Автоматическое извлечение тегов из отзывов
- Анализ тональности отзывов

### **Актуальность разработки**

Существующие аналоги не полностью покрывают потребности пользователей в области **автоматизированного анализа ресторанного рынка с объединением личных и общедоступных данных**. 

**RestoMaps Analytics** является **уникальной в своей категории** системой, которая решает эту проблему, предоставляя:

- ✅ Полную автоматизацию процессов
- ✅ Интеграцию персональных данных
- ✅ Современную визуализацию
- ✅ Комплексную аналитику
- ✅ Простоту использования

## 🛠️ Технологический стек

### **Backend & Core**
- **Python 3.11** — основной язык программирования
- **FastAPI 0.104.1** — API фреймворк для высокопроизводительных веб-приложений
- **Streamlit 1.28.1** — фреймворк для создания интерактивных веб-приложений
- **SQLAlchemy 2.0.23** — ORM для работы с базой данных
- **PostgreSQL 15** — реляционная база данных

### **Data Processing & Analysis**
- **Pandas 2.1.4** — анализ и обработка данных
- **NumPy 1.25.2** — вычисления с многомерными массивами
- **Scikit-learn 1.3.2** — машинное обучение и анализ данных
- **spaCy 3.7.2** — продвинутая обработка естественного языка
- **NLTK 3.8.1** — библиотека для работы с человеческим языком
- **TextBlob 0.17.1** — упрощенная обработка текста

### **Visualization & Mapping**
- **Folium 0.15.0** — создание интерактивных карт
- **PyDeck 0.8.1b0** — 3D визуализация данных
- **Plotly 5.17.0** — интерактивная визуализация данных
- **Matplotlib 3.8.2** — построение графиков и диаграмм
- **Seaborn 0.13.0** — статистическая визуализация данных

### **Web Scraping & Automation**
- **Selenium 4.15.2** — автоматизация веб-браузера для парсинга
- **BeautifulSoup4 4.12.2** — парсинг HTML и XML
- **Requests 2.31.0** — HTTP библиотека для API запросов
- **APScheduler 3.10.4** — планировщик задач (cron-like scheduler)

### **APIs & Integrations**
- **notion-client 2.5.0** — официальный клиент для Notion API
- **Яндекс.Геосуггест API** — поиск и подсказки мест по названию
- **Яндекс.Геокодер API** — геокодирование адресов (получение координат)
- **Яндекс.Карты** — источник отзывов и рейтингов заведений

### **Task Scheduling & Automation**
- **APScheduler 3.10.4** — планировщик задач (cron-like scheduler)
  - Автоматическая синхронизация с Notion (ежедневно в 06:00)
  - Парсинг новых отзывов (ежедневно в 08:00)
  - NLP обработка отзывов (ежедневно в 09:00)

### **Infrastructure & Deployment**
- **Docker & Docker Compose** — контейнеризация и оркестрация
- **PostgreSQL** — основная база данных
- **Cron** — автоматические бэкапы БД (ежедневно в 02:00 через backup.sh)
- **Nginx** — веб-сервер (опционально)

### **Logging & Monitoring**
- **loguru 0.7.3** — структурированное логирование с ротацией файлов
- **Sentry SDK 2.40.0** — мониторинг ошибок и производительности в production
- **python-dotenv 1.1.1** — управление переменными окружения

### **Development & Quality**
- **pytest 7.4.3** — тестирование
- **black 23.11.0** — форматирование кода
- **flake8 7.3.0** — проверка стиля кода
- **mypy 1.7.1** — статическая типизация

## 🏗️ Архитектура системы

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Notion API    │    │  Яндекс.Карты   │    │   PostgreSQL    │
│                 │    │                 │    │                 │
│ • База знаний   │    │ • Отзывы        │    │ • Рестораны     │
│ • Рестораны     │◄──►│ • Рейтинги      │◄──►│ • Отзывы        │
│ • Посещения     │    │ • Адреса        │    │ • NLP данные    │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         ▲                        ▲                        ▲
         │                        │                        │
         ▼                        ▼                        ▼
┌─────────────────────────────────────────────────────────────────┐
│                    RestoMaps Analytics                          │
│                                                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐             │
│  │  Scheduler  │  │  NLP Engine │  │  Web UI     │             │
│  │             │  │             │  │             │             │
│  │ • Notion    │  │ • spaCy     │  │ • Streamlit │             │
│  │ • Reviews   │  │ • NLTK      │  │ • Maps      │             │
│  │ • NLP       │  │ • TextBlob  │  │ • Charts    │             │
│  └─────────────┘  └─────────────┘  └─────────────┘             │
└─────────────────────────────────────────────────────────────────┘
```

## 📋 Основные модули

### **Core Services**
- **`main.py`** — точка входа, управление режимами работы
- **`scheduler.py`** — планировщик задач
- **`job_manager.py`** — менеджер джобов
- **`logger.py`** — система логирования

### **Data Processing**
- **`notion_data.py`** — синхронизация с Notion
- **`ya_maps_reviews_parser.py`** — парсинг отзывов с Яндекс.Карт
- **`nlp_analyzer.py`** — анализ текстов отзывов
- **`nlp_processor.py`** — обработка NLP задач

### **Database Layer**
- **`database/`** — модели данных, CRUD операции, управление БД
- **`models.py`** — SQLAlchemy модели
- **`crud.py`** — операции с базой данных
- **`database.py`** — подключение и инициализация

### **Web Interface**
- **`ui/`** — пользовательский интерфейс
- **`pages/`** — страницы приложения
- **`components/`** — переиспользуемые компоненты

### **Jobs & Automation**
- **`jobs/`** — автоматические задачи
- **`backup.sh`** — скрипт резервного копирования

## 🚀 Быстрый старт

### **Локальный запуск**
```bash
# 1. Клонирование репозитория
git clone <repository-url>
cd RestoMaps-Analytics

# 2. Установка зависимостей
pip install -r requirements.txt

# 3. Настройка конфигурации
cp env.example config/.env
# Отредактируйте config/.env и заполните API ключи

# 4. Инициализация базы данных
python main.py --init-db

# 5. Синхронизация с Notion
python main.py --notion

# 6. Запуск веб-интерфейса
python main.py --ui
```

### **Docker запуск**
```bash
# 1. Клонирование и настройка
git clone <repository-url>
cd RestoMaps-Analytics
cp env.example config/.env

# 2. Запуск через Docker Compose
docker-compose up -d

# 3. Первоначальная синхронизация с Notion
docker-compose exec app python main.py --notion

# 4. Откройте в браузере: http://localhost:8501
```

## 📚 Документация

- **[docs/TECHNICAL.md](docs/TECHNICAL.md)** — технические детали, архитектура, схемы
- **[docs/DEPLOY.md](docs/DEPLOY.md)** — подробные инструкции по развертыванию

